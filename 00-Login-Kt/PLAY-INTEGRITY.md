- Server should be careful to not make too many calls to the Google server
- Requests to the API are subject to a maximum number per app per day, as determined by the calling app’s assigned usage tier. The following table presents the different tiers:
    - Standard -	Up to 10,000   - 	Available to apps using any distribution channel
    - Raised   - 	Over 10,000 limit subject to approval   -	Must correctly implement API logic including retries
      Available to apps using any distribution channel in addition to Google Play
- Set up quota monitoring and alerting - https://developer.android.com/google/play/integrity/overview
- References
    - Home page - https://developer.android.com/google/play/integrity
    - Details on Android Play Integrity - https://support.google.com/googleplay/android-developer/answer/11395166?hl=en

## Exclude showing app in Play Store for untrusted device
- You can exclude devices from your app’s distribution on Google Play based on their Integrity API response to the Play Store.
  Excluded devices won’t be able to see or install your app on Google Play.
  Device exclusion does not prevent users from obtaining your app another way such as
  through another distribution channel or via sideloading.

- Security Questions
    - DeviceCheck won't avoid people abusing login to generate access_token until the ID generated by Apple will be verified only once and revoked. If same token can be verified each time, the user can sniff it once and reuse the same token again and again to generate proper token as Apple will keep saying the token is verified (Replay Attack).
    - Android recommends generating the nonce on the server end and then checking for the same nonce on signature is verified. This will ensure the nonce generated is not subjected to replay attack.
    - If we generate the nonce ourselves on the client side, then the nonce cannot be verified to avoid replay attack.
    - To avoid this, the nonce itself can be a timestamp. When generating the access_token, if the nonce is expired, we can throw an error. This way we reduce the timeline to do a replay attack.
      Avoiding Replay Attacks

- Avoiding Replay Attacks
    - Apple does this by providing temporary token so replay is not possible
    - in Android we get a signed JWT, this can be replayed, To avoid this we will set a nonce, but this nonce has to be stored and checked on the server end to ensure a request is not replayed
    - Android recommended way is to generate a unique value on the server, pass it to the app, then use it as a nonce to verify the request, but this wouldn't be feasible in Android

- How to implement
    - Click "LOG IN WITH BROWSER"

- Google Codelabs
    - https://developer.android.com/codelabs/add-play-integrity?hl=en#0
    - Github Sample - https://github.com/android/add-play-integrity-codelab
    - Sample Project for Server - https://github.com/1nikolas/play-integrity-checker-server